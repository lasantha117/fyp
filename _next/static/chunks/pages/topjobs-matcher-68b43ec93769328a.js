(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[264],{3196:(e,a,s)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/topjobs-matcher",function(){return s(8285)}])},4239:(e,a,s)=>{"use strict";s.d(a,{A:()=>r});var t=s(7876);function r(e){let{jobDescription:a,resumes:s}=e,r=(e,a)=>{let s=new Set(e.toLowerCase().split(/\W+/).filter(e=>e.length>0)),t=new Set(a.toLowerCase().split(/\W+/).filter(e=>e.length>0));return[...s].filter(e=>t.has(e)&&e.length>3)};return(0,t.jsxs)("div",{className:"mt-4 p-3 bg-gray-50 rounded-lg shadow-inner",children:[(0,t.jsx)("h6",{className:"text-lg font-semibold text-gray-700 mb-3",children:"\uD83D\uDD0D Matching Keywords:"}),s.map((e,s)=>(0,t.jsxs)("div",{className:"mb-3",children:[(0,t.jsxs)("p",{className:"text-md font-medium text-gray-600",children:["Resume: ",(0,t.jsx)("span",{className:"font-normal",children:e.filename})]}),(0,t.jsx)("div",{className:"flex flex-wrap gap-2 mt-2",children:r(a,e.text).length>0?r(a,e.text).map((e,a)=>(0,t.jsx)("span",{className:"px-3 py-1 bg-green-200 text-green-800 rounded-full text-sm font-medium shadow-sm",children:e},a)):(0,t.jsx)("span",{className:"text-gray-500 text-sm",children:"No significant matching keywords found."})})]},s))]})}s(4232)},5538:(e,a,s)=>{"use strict";var t=s(6042),r=s(5940),l=s(9917),n=s(5226);let i=(0,t.Wp)({apiKey:"AIzaSyDfp_Ya2eIUMFRg0Ub1ICsgvKqPMoWk4lM",authDomain:"fyp-bbe4d.firebaseapp.com",databaseURL:"https://fyp-bbe4d-default-rtdb.asia-southeast1.firebasedatabase.app",projectId:"fyp-bbe4d",storageBucket:"fyp-bbe4d.appspot.com",messagingSenderId:"75697914820",appId:"1:75697914820:web:7bab142f2d6313cf1c1a91"});(0,r.C3)(i),(0,l.xI)(i),(0,n.c7)(i)},8285:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>h});var t=s(7876),r=s(4232),l=s(1040),n=s(1237);s(1912);var i=s(5940),o=s(9917),c=s(9366),d=s(4239),m=s(9099);function h(){let[e,a]=(0,r.useState)([]),[s,h]=(0,r.useState)(""),[u,b]=(0,r.useState)([]),[p,x]=(0,r.useState)({}),[g,j]=(0,r.useState)(!1),[f,v]=(0,r.useState)(!1),[N,y]=(0,r.useState)(null),[w,_]=(0,r.useState)(null),[k,J]=(0,r.useState)(""),D=(0,o.xI)(),T=(0,m.useRouter)();(0,r.useEffect)(()=>{let e=(0,o.hg)(D,async e=>{if(e){y(e);let a=(0,i.C3)(),s=(0,i.KR)(a,"users/".concat(e.uid,"/role")),t=await (0,i.Jt)(s);t.exists()?_(t.val()):(_(null),D.signOut(),T.push("/login"))}else y(null),_(null),T.push("/login")});return()=>e()},[D,T]);let S=(0,r.useCallback)(async e=>new Promise((a,s)=>{let t=new FileReader;t.onload=async t=>{let r=t.target.result;if("text/plain"===e.type)a(new TextDecoder("utf-8").decode(r));else{let t=new FormData;t.append("resumes",e),t.append("job_description","dummy");try{let e=await l.A.post("http://localhost:5000/api/matcher",t,{headers:{"Content-Type":"multipart/form-data"}});e.data&&e.data.results&&e.data.results.length>0?a(e.data.results[0].text):s(Error("Failed to extract text from file via backend."))}catch(e){s(Error("Backend extraction error: ".concat(e.message)))}}},t.onerror=e=>s(e),t.readAsArrayBuffer(e)}),[]),C=async()=>{h("\uD83D\uDD0D Scraping TopJobs.lk for IT vacancies. This may take a moment..."),j(!0),b([]),x({});try{let e=await l.A.get("http://localhost:5000/api/scrape-topjobs");e.data&&e.data.jobs?(b(e.data.jobs),h("✅ Found ".concat(e.data.jobs.length," jobs from TopJobs.lk."))):h("No jobs found or an error occurred during scraping.")}catch(s){var e,a;console.error("Error scraping TopJobs:",s),h("\uD83D\uDEAB Error scraping jobs: ".concat((null===(a=s.response)||void 0===a?void 0:null===(e=a.data)||void 0===e?void 0:e.message)||s.message,". Check backend console for details."))}finally{j(!1)}},M=async()=>{if(!N||"candidate"!==w){h("⚠️ Please log in as a candidate to match resumes.");return}if(0===e.length){h("⚠️ Please upload your resume first.");return}if(0===u.length){h("⚠️ Please scrape jobs from TopJobs.lk first.");return}h("\uD83D\uDD0D Matching your resume to scraped TopJobs.lk vacancies. Please wait..."),v(!0),x({});try{let a=e[0],s=await S(a);J(s);let t=await l.A.post("http://localhost:5000/api/get_all_matched_jobs",{resume_text:s,jobList:u});if(t.data&&t.data.results){let e={};t.data.results.forEach(t=>{e[t.Job_ID]=[{filename:a.name,text:s,match_percentage:t.match_percentage,matched_keywords:t.matching_words,jobTitle:t.Job_Title,company:t.Company_Name,jobDescription:t.Job_Description,jobUrl:t.Job_URL,source:t.Source}]}),x(e),h("✅ Matching complete!")}else h("No matching results found or an error occurred.")}catch(e){var a,s;console.error("Error matching scraped jobs:",e),h("\uD83D\uDEAB Error matching jobs: ".concat((null===(s=e.response)||void 0===s?void 0:null===(a=s.data)||void 0===a?void 0:a.message)||e.message))}finally{v(!1)}},I=async e=>{if(!N||"candidate"!==w){h("⚠️ Please log in as a candidate to apply for jobs.");return}if(!k){h("⚠️ Please upload and match your resume first before applying.");return}if(!e.Job_ID||!N.uid||!N.email||!k||!e.Job_Title||!e.Job_URL||!e.Source){h("\uD83D\uDEAB Missing critical data for application. Cannot apply."),console.error("Missing application data for external job:",{jobId:e.Job_ID,candidateUserId:N.uid,candidateEmail:N.email,resumeText:k,jobTitle:e.Job_Title,jobUrl:e.Job_URL,source:e.Source});return}h("Submitting application for ".concat(e.Job_Title,"..."));try{let a=await l.A.post("http://localhost:5000/api/apply",{jobId:e.Job_ID,companyUserId:"",candidateUserId:N.uid,candidateEmail:N.email,resumeText:k,jobTitle:e.Job_Title,jobUrl:e.Job_URL,jobSource:e.Source});a.data&&a.data.message?(h("✅ ".concat(a.data.message)),window.open(e.Job_URL,"_blank")):h("Application submitted, but no confirmation message received.")}catch(e){var a,s;console.error("Error submitting application:",e),h("\uD83D\uDEAB Failed to submit application: ".concat((null===(s=e.response)||void 0===s?void 0:null===(a=s.data)||void 0===a?void 0:a.message)||e.message))}};return N&&null!==w?"candidate"!==w?(0,t.jsx)("div",{className:"container mt-5 alert alert-danger text-center",children:"Access Denied. Please log in as a candidate to view this page."}):(0,t.jsxs)("div",{children:[(0,t.jsx)(c.A,{onLogout:()=>D.signOut().then(()=>T.push("/login")),userEmail:null==N?void 0:N.email}),(0,t.jsx)("div",{className:"container mt-5",children:(0,t.jsxs)("div",{className:"card shadow rounded-2xl",children:[(0,t.jsxs)("div",{className:"card-header bg-primary text-white p-4 rounded-t-2xl",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold",children:"TopJobs.lk IT Job Matcher"}),(0,t.jsx)("p",{className:"mb-0",children:"Find and match with IT jobs directly from TopJobs.lk!"})]}),(0,t.jsxs)("div",{className:"card-body p-4",children:[(0,t.jsxs)("div",{className:"mb-4 border-b pb-4",children:[(0,t.jsx)("h3",{className:"text-xl font-semibold mb-3",children:"1. Fetch Jobs from TopJobs.lk"}),(0,t.jsx)("button",{className:"btn btn-info px-4 py-2 rounded-full shadow-md hover:bg-info-dark transition duration-300",onClick:C,disabled:g,children:g?"Scraping...":"Scrape Latest IT Jobs"}),u.length>0&&(0,t.jsxs)("p",{className:"mt-3 text-success",children:["Successfully scraped ",u.length," jobs."]})]}),(0,t.jsxs)("div",{className:"mb-4 border-b pb-4",children:[(0,t.jsx)("h3",{className:"text-xl font-semibold mb-3",children:"2. Upload Your Resume & Match"}),(0,t.jsxs)("div",{className:"form-group mb-3",children:[(0,t.jsx)("label",{htmlFor:"resumes",className:"form-label text-gray-700 font-medium",children:"Upload Your Resume (PDF, DOCX, TXT)"}),(0,t.jsx)("input",{type:"file",className:"form-control form-control-lg border rounded-lg p-2",id:"resumes",multiple:!1,accept:".pdf,.docx,.txt",onChange:e=>{a(Array.from(e.target.files)),h(""),x({}),J("")}}),e.length>0&&(0,t.jsxs)("p",{className:"mt-2 text-sm text-gray-600",children:["Selected file: ",(0,t.jsx)("span",{className:"font-semibold",children:e[0].name})]})]}),(0,t.jsx)("button",{className:"btn btn-success px-4 py-2 rounded-full shadow-md hover:bg-green-600 transition duration-300",onClick:M,disabled:0===e.length||0===u.length||f||!N||"candidate"!==w,children:f?"Matching...":"Match My Resume to Scraped Jobs"})]}),s&&(0,t.jsx)("div",{className:"alert ".concat(s.includes("Error")||s.includes("\uD83D\uDEAB")||s.includes("⚠️")?"alert-danger":"alert-info"," mt-3 p-3 rounded-lg"),children:s}),(0,t.jsxs)("div",{className:"mt-5",children:[(0,t.jsx)("h4",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Matched TopJobs.lk Vacancies (Sorted by Match)"}),g?(0,t.jsx)("p",{className:"text-center text-muted",children:"Loading job listings..."}):0===u.length?(0,t.jsx)("p",{className:"text-center text-gray-500",children:'Click "Scrape Latest IT Jobs" to fetch listings.'}):f?(0,t.jsx)("p",{className:"text-center text-muted",children:"Matching jobs..."}):0===Object.keys(p).length&&u.length>0?(0,t.jsx)("p",{className:"text-center text-gray-500",children:'Upload your resume and click "Match My Resume to Scraped Jobs" to see results.'}):Object.values(p).flat().sort((e,a)=>a.match_percentage-e.match_percentage).map((e,a)=>{let s=Math.min(100,Math.max(0,Math.round(e.match_percentage)));return(0,t.jsxs)("div",{className:"border rounded-2xl p-4 mb-4 shadow-md bg-white",children:[(0,t.jsxs)("p",{className:"mb-1",children:[(0,t.jsx)("strong",{className:"text-gray-800",children:"Job Title:"})," ",e.Job_Title]}),(0,t.jsxs)("p",{className:"mb-1",children:[(0,t.jsx)("strong",{className:"text-gray-800",children:"Company:"})," ",e.Company_Name]}),(0,t.jsxs)("p",{className:"mb-1",children:[(0,t.jsx)("strong",{className:"text-gray-800",children:"Source:"})," ",e.Source]}),(0,t.jsxs)("p",{className:"mb-1",children:[(0,t.jsx)("strong",{className:"text-gray-800",children:"Description:"})," ",e.Job_Description.substring(0,200),"..."]})," ",(0,t.jsx)("a",{href:e.Job_URL,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:"View Full Job"}),(0,t.jsxs)("div",{className:"mt-4 border-t pt-3 border-gray-200",children:[(0,t.jsx)("p",{className:"text-md font-medium text-gray-700",children:(0,t.jsx)("strong",{children:"Match Percentage:"})}),(0,t.jsxs)("div",{className:"flex flex-col items-center",children:[(0,t.jsx)("div",{style:{width:100,height:100},children:(0,t.jsx)(n.QF,{value:s,text:"".concat(s,"%"),styles:(0,n.Hf)({pathColor:s>75?"#2ecc71":s>50?"#f39c12":"#e74c3c",textColor:"#000",trailColor:"#eee",textSize:"18px"})})}),(0,t.jsx)("button",{className:"btn btn-outline-dark mt-3 px-4 py-2 rounded-full shadow-sm hover:bg-gray-100 transition duration-300",onClick:()=>{x(a=>{let s={...a},t=s[e.Job_ID];return t&&t[0]&&(t[0].showKeywords=!t[0].showKeywords),s})},children:e.showKeywords?"Hide Matched Words":"Show Matched Words"}),e.showKeywords&&(0,t.jsx)("div",{className:"mt-2 w-full",children:(0,t.jsx)(d.A,{jobDescription:e.Job_Description,resumes:[e]})})]})]}),(0,t.jsx)("div",{className:"flex flex-col items-center mt-4",children:(0,t.jsx)("div",{children:(0,t.jsx)("button",{className:"btn btn-primary px-6 py-2 rounded-full shadow-md hover:bg-blue-700 transition duration-300",onClick:()=>I(e),disabled:!N||"candidate"!==w||!k,children:N&&"candidate"===w?"Apply Now":"Login as Candidate to Apply"})})})]},e.Job_ID)})]})]})]})})]}):(0,t.jsxs)("div",{className:"container mt-5 text-center",children:[(0,t.jsx)("div",{className:"spinner-border text-primary",role:"status",children:(0,t.jsx)("span",{className:"visually-hidden",children:"Loading..."})}),(0,t.jsx)("p",{className:"mt-2",children:"Authenticating..."})]})}s(5538)},9366:(e,a,s)=>{"use strict";s.d(a,{A:()=>c});var t=s(7876),r=s(4232),l=s(8230),n=s.n(l),i=s(9917),o=s(5940);function c(e){let{onLogout:a,userEmail:s}=e,[l,c]=(0,r.useState)(null),d=(0,i.xI)(),m=(0,o.C3)();return(0,r.useEffect)(()=>{let e=(0,i.hg)(d,async e=>{if(e){let a=(0,o.KR)(m,"users/".concat(e.uid,"/role")),s=await (0,o.Jt)(a);s.exists()?c(s.val()):c(null)}else c(null)});return()=>e()},[d,m]),(0,t.jsx)("nav",{className:"navbar navbar-expand-lg navbar-dark bg-dark",children:(0,t.jsxs)("div",{className:"container-fluid",children:["company"===l?(0,t.jsx)(n(),{href:"/dashboard",className:"navbar-brand",children:"Company Portal"}):"candidate"===l?(0,t.jsx)(n(),{href:"/candidate-dashboard",className:"navbar-brand",children:"Candidate Portal"}):(0,t.jsx)(n(),{href:"/",className:"navbar-brand",children:"Job Matching Platform"}),(0,t.jsx)("button",{className:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarNav","aria-controls":"navbarNav","aria-expanded":"false","aria-label":"Toggle navigation",children:(0,t.jsx)("span",{className:"navbar-toggler-icon"})}),(0,t.jsxs)("div",{className:"collapse navbar-collapse",id:"navbarNav",children:[(0,t.jsxs)("ul",{className:"navbar-nav me-auto mb-2 mb-lg-0",children:["company"===l&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("li",{className:"nav-item",children:(0,t.jsx)(n(),{href:"/dashboard",className:"nav-link",children:"Dashboard"})}),(0,t.jsx)("li",{className:"nav-item",children:(0,t.jsx)(n(),{href:"/all-vacancies",className:"nav-link",target:"_blank",rel:"noopener noreferrer",children:"All Vacancies"})}),(0,t.jsx)("li",{className:"nav-item",children:(0,t.jsx)(n(),{href:"/view-vacancies",className:"nav-link",children:"My Vacancies"})})]}),"candidate"===l&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("li",{className:"nav-item",children:(0,t.jsx)(n(),{href:"/candidate-dashboard",className:"nav-link",children:"Dashboard"})}),(0,t.jsx)("li",{className:"nav-item",children:(0,t.jsx)(n(),{href:"/resume-matcher",className:"nav-link",children:"Platform Job Matcher"})}),(0,t.jsx)("li",{className:"nav-item",children:(0,t.jsx)(n(),{href:"/topjobs-matcher",className:"nav-link",children:"TopJobs.lk Matcher"})}),(0,t.jsx)("li",{className:"nav-item",children:(0,t.jsx)(n(),{href:"/all-vacancies",className:"nav-link",target:"_blank",rel:"noopener noreferrer",children:"View All Jobs"})})]}),!l&&(0,t.jsx)("li",{className:"nav-item",children:(0,t.jsx)(n(),{href:"/",className:"nav-link",children:"Home"})})]}),(0,t.jsxs)("ul",{className:"navbar-nav",children:[s&&(0,t.jsx)("li",{className:"nav-item",children:(0,t.jsxs)("span",{className:"nav-link text-white-50",children:["Signed in as: ",s]})}),(0,t.jsx)("li",{className:"nav-item",children:(0,t.jsx)("button",{className:"btn btn-outline-light ms-2",onClick:a,children:"Logout"})})]})]})]})})}s(5538)}},e=>{var a=a=>e(e.s=a);e.O(0,[7,166,3,230,149,636,593,792],()=>a(3196)),_N_E=e.O()}]);