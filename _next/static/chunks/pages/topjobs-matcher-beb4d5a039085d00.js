(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[264],{3196:(e,a,s)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/topjobs-matcher",function(){return s(8285)}])},4239:(e,a,s)=>{"use strict";s.d(a,{A:()=>r});var t=s(7876);function r(e){let{job:a}=e;if(!a||!a.matching_words)return console.warn("MatchingKeywords received undefined job or matching_words prop."),null;let{filename:s,matching_words:r}=a;return(0,t.jsxs)("div",{className:"mt-4 p-3 bg-gray-50 rounded-lg shadow-inner",children:[(0,t.jsx)("h6",{className:"text-lg font-semibold text-gray-700 mb-3",children:"\uD83D\uDD0D Matching Keywords:"}),(0,t.jsxs)("div",{className:"mb-3",children:[(0,t.jsxs)("p",{className:"text-md font-medium text-gray-600",children:["Resume: ",(0,t.jsx)("span",{className:"font-normal",children:s||"N/A"})]}),(0,t.jsx)("div",{className:"flex flex-wrap gap-2 mt-2",children:r.length>0?r.map((e,a)=>(0,t.jsx)("span",{className:"px-3 py-1 bg-green-200 text-green-800 rounded-full text-sm font-medium shadow-sm",children:e},a)):(0,t.jsx)("span",{className:"text-gray-500 text-sm",children:"No significant matching keywords found."})})]})]})}s(4232)},5538:(e,a,s)=>{"use strict";var t=s(6042),r=s(5940),n=s(9917),l=s(5226);let o=(0,t.Wp)({apiKey:"AIzaSyDfp_Ya2eIUMFRg0Ub1ICsgvKqPMoWk4lM",authDomain:"fyp-bbe4d.firebaseapp.com",databaseURL:"https://fyp-bbe4d-default-rtdb.asia-southeast1.firebasedatabase.app",projectId:"fyp-bbe4d",storageBucket:"fyp-bbe4d.firebasestorage.app",messagingSenderId:"75697914820",appId:"1:75697914820:web:7bab142f2d6313cf1c1a91"});(0,r.C3)(o),(0,n.xI)(o),(0,l.c7)(o)},8285:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>h});var t=s(7876),r=s(4232),n=s(1040),l=s(1237);s(1912);var o=s(5940),i=s(9917),c=s(9366),d=s(4239),m=s(9099);function h(){let[e,a]=(0,r.useState)(""),[s,h]=(0,r.useState)([]),[p,u]=(0,r.useState)({}),[b,x]=(0,r.useState)(!1),[g,j]=(0,r.useState)(!1),[f,v]=(0,r.useState)(null),[N,y]=(0,r.useState)(null),[w,_]=(0,r.useState)(null),k=(0,i.xI)(),J=(0,m.useRouter)();(0,r.useEffect)(()=>{let e=(0,i.hg)(k,async e=>{if(e){v(e);let a=(0,o.C3)(),s=(0,o.KR)(a,"users/".concat(e.uid,"/role")),t=await (0,o.Jt)(s);t.exists()?y(t.val()):(y(null),k.signOut(),J.push("/login"))}else v(null),y(null),J.push("/login")});return()=>e()},[k,J]);let D=(0,r.useCallback)(async e=>new Promise((a,s)=>{let t=new FileReader;t.onload=async t=>{let r=t.target.result;if("text/plain"===e.type)a(new TextDecoder("utf-8").decode(r));else{let t=new FormData;t.append("resumes",e),t.append("job_description","dummy");try{let e=await n.A.post("http://localhost:5000/api/matcher",t,{headers:{"Content-Type":"multipart/form-data"}});e.data&&e.data.results&&e.data.results.length>0?a(e.data.results[0].text):s(Error("Failed to extract text from file via backend."))}catch(e){s(Error("Backend extraction error: ".concat(e.message)))}}},t.onerror=e=>s(e),t.readAsArrayBuffer(e)}),[]),T=async()=>{a("\uD83D\uDD0D Scraping TopJobs.lk for IT vacancies. This may take a moment..."),x(!0),h([]),u({});try{let e=await n.A.get("http://localhost:5000/api/scrape-topjobs");if(e.data&&e.data.jobs){let s=e.data.jobs.map(e=>({...e,showKeywords:!1}));h(s),a("✅ Found ".concat(e.data.jobs.length," jobs from TopJobs.lk."))}else a("No jobs found or an error occurred during scraping.")}catch(t){var e,s;console.error("Error scraping TopJobs:",t),a("\uD83D\uDEAB Error scraping jobs: ".concat((null===(s=t.response)||void 0===s?void 0:null===(e=s.data)||void 0===e?void 0:e.message)||t.message,". Check backend console for details."))}finally{x(!1)}},S=async()=>{if(!f||"candidate"!==N){a("⚠️ Please log in as a candidate to match resumes.");return}if(!w){a("⚠️ Please upload your resume first.");return}if(0===s.length){a("⚠️ Please scrape jobs from TopJobs.lk first.");return}a("\uD83D\uDD0D Matching your resume to scraped TopJobs.lk vacancies. Please wait..."),j(!0),u({});try{let e=await D(w),t=await n.A.post("http://localhost:5000/api/get_all_matched_jobs",{resume_text:e,jobList:s});if(t.data&&t.data.results){let s={};t.data.results.forEach(a=>{s[a.Job_ID]=[{filename:w.name,text:e,match_percentage:a.match_percentage,matched_keywords:a.matching_words,jobTitle:a.Job_Title,company:a.Company_Name,jobDescription:a.Job_Description,jobUrl:a.Job_URL,source:a.Source,showKeywords:!1}]}),u(s),a("✅ Matching complete!")}else a("No matching results found or an error occurred.")}catch(s){var e,t;console.error("Error matching scraped jobs:",s),a("\uD83D\uDEAB Error matching jobs: ".concat((null===(t=s.response)||void 0===t?void 0:null===(e=t.data)||void 0===e?void 0:e.message)||s.message))}finally{j(!1)}},M=async e=>{if(!f||"candidate"!==N){a("⚠️ Please log in as a candidate to apply for jobs.");return}if(!w){a("⚠️ Please upload and match your resume first before applying.","danger");return}if(!e.Job_ID||!f.uid||!f.email||!w||!e.Job_Title||!e.Job_URL||!e.Source){a("\uD83D\uDEAB Missing critical data for application. Cannot apply."),console.error("Missing application data for external job:",{jobId:e.Job_ID,candidateUserId:f.uid,candidateEmail:f.email,resumeFile:w.name,jobTitle:e.Job_Title,jobUrl:e.Job_URL,source:e.Source});return}a("Submitting application for ".concat(e.Job_Title,"..."));try{let s=p[e.Job_ID],t=s&&s.length>0?s[0].match_percentage:0,r=new FormData;r.append("resume_file",w),r.append("jobId",e.Job_ID),r.append("companyUserId",e.companyUserId||""),r.append("candidateUserId",f.uid),r.append("candidateEmail",f.email),r.append("jobTitle",e.Job_Title),r.append("jobUrl",e.Job_URL||""),r.append("jobSource",e.Source),r.append("matchPercentage",t.toString());let l=await n.A.post("http://localhost:5000/api/apply",r,{headers:{"Content-Type":"multipart/form-data"}});l.data&&l.data.message?(a("✅ ".concat(l.data.message)),window.open(e.Job_URL,"_blank")):a("Application submitted, but no confirmation message received.")}catch(e){var s,t;console.error("Error submitting application:",e),a("\uD83D\uDEAB Failed to submit application: ".concat((null===(t=e.response)||void 0===t?void 0:null===(s=t.data)||void 0===s?void 0:s.message)||e.message))}finally{setTimeout(()=>{a("")},5e3)}};return f&&null!==N?"candidate"!==N?(0,t.jsx)("div",{className:"container mt-5 alert alert-danger text-center",children:"Access Denied. Please log in as a candidate to view this page."}):(0,t.jsxs)("div",{children:[(0,t.jsx)(c.A,{onLogout:()=>k.signOut().then(()=>J.push("/login")),userEmail:null==f?void 0:f.email}),(0,t.jsx)("div",{className:"container mt-5",children:(0,t.jsxs)("div",{className:"card shadow rounded-2xl",children:[(0,t.jsxs)("div",{className:"card-header bg-primary text-white p-4 rounded-t-2xl",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold",children:"TopJobs.lk IT Job Matcher"}),(0,t.jsx)("p",{className:"mb-0",children:"Find and match with IT jobs directly from TopJobs.lk!"})]}),(0,t.jsxs)("div",{className:"card-body p-4",children:[(0,t.jsxs)("div",{className:"mb-4 border-b pb-4",children:[(0,t.jsx)("h3",{className:"text-xl font-semibold mb-3",children:"1. Fetch Jobs from TopJobs.lk"}),(0,t.jsx)("button",{className:"btn btn-info px-4 py-2 rounded-full shadow-md hover:bg-info-dark transition duration-300",onClick:T,disabled:b,children:b?"Scraping...":"Scrape Latest IT Jobs"}),s.length>0&&(0,t.jsxs)("p",{className:"mt-3 text-success",children:["Successfully scraped ",s.length," jobs."]})]}),(0,t.jsxs)("div",{className:"mb-4 border-b pb-4",children:[(0,t.jsx)("h3",{className:"text-xl font-semibold mb-3",children:"2. Upload Your Resume & Match"}),(0,t.jsxs)("div",{className:"form-group mb-3",children:[(0,t.jsx)("label",{htmlFor:"resumes",className:"form-label text-gray-700 font-medium",children:"Upload Your Resume (PDF, DOCX, TXT)"}),(0,t.jsx)("input",{type:"file",className:"form-control form-control-lg border rounded-lg p-2",id:"resumes",multiple:!1,accept:".pdf,.docx,.txt",onChange:e=>{_(e.target.files[0]||null),a(""),u({})}}),w&&(0,t.jsxs)("p",{className:"mt-2 text-sm text-gray-600",children:["Selected file: ",(0,t.jsx)("span",{className:"font-semibold",children:w.name})]})]}),(0,t.jsx)("button",{className:"btn btn-success px-4 py-2 rounded-full shadow-md hover:bg-green-600 transition duration-300",onClick:S,disabled:!w||0===s.length||g||!f||"candidate"!==N,children:g?"Matching...":"Match My Resume to Scraped Jobs"})]}),e&&(0,t.jsx)("div",{className:"alert ".concat(e.includes("Error")||e.includes("\uD83D\uDEAB")||e.includes("⚠️")?"alert-danger":"alert-info"," mt-3 p-3 rounded-lg"),children:e}),(0,t.jsxs)("div",{className:"mt-5",children:[(0,t.jsx)("h4",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Matched TopJobs.lk Vacancies (Sorted by Match)"}),b?(0,t.jsx)("p",{className:"text-center text-muted",children:"Loading job listings..."}):0===s.length?(0,t.jsx)("p",{className:"text-center text-gray-500",children:'Click "Scrape Latest IT Jobs" to fetch listings.'}):g?(0,t.jsx)("p",{className:"text-center text-muted",children:"Matching jobs..."}):0===Object.keys(p).length&&s.length>0?(0,t.jsx)("p",{className:"text-center text-gray-500",children:'Upload your resume and click "Match My Resume to Scraped Jobs" to see results.'}):Object.values(p).flat().sort((e,a)=>a.match_percentage-e.match_percentage).map((e,a)=>{let s=Math.min(100,Math.max(0,Math.round(e.match_percentage)));return(0,t.jsxs)("div",{className:"border rounded-2xl p-4 mb-4 shadow-md bg-white",children:[(0,t.jsxs)("p",{className:"mb-1",children:[(0,t.jsx)("strong",{className:"text-gray-800",children:"Job Title:"})," ",e.Job_Title]}),(0,t.jsxs)("p",{className:"mb-1",children:[(0,t.jsx)("strong",{className:"text-gray-800",children:"Company:"})," ",e.Company_Name]}),(0,t.jsxs)("p",{className:"mb-1",children:[(0,t.jsx)("strong",{className:"text-gray-800",children:"Source:"})," ",e.Source]}),(0,t.jsxs)("p",{className:"mb-1",children:[(0,t.jsx)("strong",{className:"text-gray-800",children:"Description:"})," ",e.Job_Description.substring(0,200),"..."]})," ",(0,t.jsx)("a",{href:e.Job_URL,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:"View Full Job"}),(0,t.jsxs)("div",{className:"mt-4 border-t pt-3 border-gray-200",children:[(0,t.jsx)("p",{className:"text-md font-medium text-gray-700",children:(0,t.jsx)("strong",{children:"Match Percentage:"})}),(0,t.jsxs)("div",{className:"flex flex-col items-center",children:[(0,t.jsx)("div",{style:{width:100,height:100},children:(0,t.jsx)(l.QF,{value:s,text:"".concat(s,"%"),styles:(0,l.Hf)({pathColor:s>75?"#2ecc71":s>50?"#f39c12":"#e74c3c",textColor:"#000",trailColor:"#eee",textSize:"18px"})})}),e.matched_keywords&&e.matched_keywords.length>0&&(0,t.jsx)("button",{className:"btn btn-outline-dark mt-3 px-4 py-2 rounded-full shadow-sm hover:bg-gray-100 transition duration-300",onClick:()=>{u(a=>{let s={...a},t=s[e.Job_ID][0];return t&&(t.showKeywords=!t.showKeywords),{...s}})},children:e.showKeywords?"Hide Matched Words":"Show Matched Words"}),e.showKeywords&&(0,t.jsx)("div",{className:"mt-2 w-full",children:(0,t.jsx)(d.A,{job:e})})]})]}),(0,t.jsx)("div",{className:"flex flex-col items-center mt-4",children:(0,t.jsx)("div",{children:(0,t.jsx)("button",{className:"btn btn-primary px-6 py-2 rounded-full shadow-md hover:bg-blue-700 transition duration-300",onClick:()=>M(e),disabled:!f||"candidate"!==N||!w,children:f&&"candidate"===N?"Apply Now":"Login as Candidate to Apply"})})})]},e.Job_ID)})]})]})]})})]}):(0,t.jsxs)("div",{className:"container mt-5 text-center",children:[(0,t.jsx)("div",{className:"spinner-border text-primary",role:"status",children:(0,t.jsx)("span",{className:"visually-hidden",children:"Loading..."})}),(0,t.jsx)("p",{className:"mt-2",children:"Authenticating..."})]})}s(5538)},9366:(e,a,s)=>{"use strict";s.d(a,{A:()=>c});var t=s(7876),r=s(4232),n=s(8230),l=s.n(n),o=s(9917),i=s(5940);function c(e){let{onLogout:a,userEmail:s}=e,[n,c]=(0,r.useState)(null),d=(0,o.xI)(),m=(0,i.C3)();return(0,r.useEffect)(()=>{let e=(0,o.hg)(d,async e=>{if(e){let a=(0,i.KR)(m,"users/".concat(e.uid,"/role")),s=await (0,i.Jt)(a);s.exists()?c(s.val()):c(null)}else c(null)});return()=>e()},[d,m]),(0,t.jsx)("nav",{className:"navbar navbar-expand-lg navbar-dark bg-dark",children:(0,t.jsxs)("div",{className:"container-fluid",children:["company"===n?(0,t.jsx)(l(),{href:"/dashboard",className:"navbar-brand",children:"Company Portal"}):"candidate"===n?(0,t.jsx)(l(),{href:"/candidate-dashboard",className:"navbar-brand",children:"Candidate Portal"}):(0,t.jsx)(l(),{href:"/",className:"navbar-brand",children:"Job Matching Platform"}),(0,t.jsx)("button",{className:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarNav","aria-controls":"navbarNav","aria-expanded":"false","aria-label":"Toggle navigation",children:(0,t.jsx)("span",{className:"navbar-toggler-icon"})}),(0,t.jsxs)("div",{className:"collapse navbar-collapse",id:"navbarNav",children:[(0,t.jsxs)("ul",{className:"navbar-nav me-auto mb-2 mb-lg-0",children:["company"===n&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("li",{className:"nav-item",children:(0,t.jsx)(l(),{href:"/dashboard",className:"nav-link",children:"Dashboard"})}),(0,t.jsx)("li",{className:"nav-item",children:(0,t.jsx)(l(),{href:"/all-vacancies",className:"nav-link",target:"_blank",rel:"noopener noreferrer",children:"All Vacancies"})}),(0,t.jsx)("li",{className:"nav-item",children:(0,t.jsx)(l(),{href:"/view-vacancies",className:"nav-link",children:"My Vacancies"})})]}),"candidate"===n&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("li",{className:"nav-item",children:(0,t.jsx)(l(),{href:"/candidate-dashboard",className:"nav-link",children:"Dashboard"})}),(0,t.jsx)("li",{className:"nav-item",children:(0,t.jsx)(l(),{href:"/resume-matcher",className:"nav-link",children:"Platform Job Matcher"})}),(0,t.jsx)("li",{className:"nav-item",children:(0,t.jsx)(l(),{href:"/topjobs-matcher",className:"nav-link",children:"TopJobs.lk Matcher"})}),(0,t.jsx)("li",{className:"nav-item",children:(0,t.jsx)(l(),{href:"/all-vacancies",className:"nav-link",target:"_blank",rel:"noopener noreferrer",children:"View All Jobs"})})]}),!n&&(0,t.jsx)("li",{className:"nav-item",children:(0,t.jsx)(l(),{href:"/",className:"nav-link",children:"Home"})})]}),(0,t.jsxs)("ul",{className:"navbar-nav",children:[s&&(0,t.jsx)("li",{className:"nav-item",children:(0,t.jsxs)("span",{className:"nav-link text-white-50",children:["Signed in as: ",s]})}),(0,t.jsx)("li",{className:"nav-item",children:(0,t.jsx)("button",{className:"btn btn-outline-light ms-2",onClick:a,children:"Logout"})})]})]})]})})}s(5538)}},e=>{var a=a=>e(e.s=a);e.O(0,[7,166,3,230,149,636,593,792],()=>a(3196)),_N_E=e.O()}]);