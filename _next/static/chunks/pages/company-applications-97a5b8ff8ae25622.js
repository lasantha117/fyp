(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[311],{1044:(e,a,s)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/company-applications",function(){return s(9279)}])},5538:(e,a,s)=>{"use strict";var l=s(6042),n=s(5940),r=s(9917),t=s(5226);let i=(0,l.Wp)({apiKey:"AIzaSyDfp_Ya2eIUMFRg0Ub1ICsgvKqPMoWk4lM",authDomain:"fyp-bbe4d.firebaseapp.com",databaseURL:"https://fyp-bbe4d-default-rtdb.asia-southeast1.firebasedatabase.app",projectId:"fyp-bbe4d",storageBucket:"fyp-bbe4d.appspot.com",messagingSenderId:"75697914820",appId:"1:75697914820:web:7bab142f2d6313cf1c1a91"});(0,n.C3)(i),(0,r.xI)(i),(0,t.c7)(i)},9279:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>d});var l=s(7876),n=s(4232),r=s(5940),t=s(9917),i=s(9099),c=s(9366);function d(){let[e,a]=(0,n.useState)([]),[s,d]=(0,n.useState)(!0),[o,h]=(0,n.useState)(""),[m,b]=(0,n.useState)(null),[p,u]=(0,n.useState)(null),[x,j]=(0,n.useState)(null),[v,N]=(0,n.useState)(!1),f=(0,i.useRouter)(),g=(0,t.xI)();(0,n.useEffect)(()=>{let e=(0,t.hg)(g,e=>{e?b(e):(b(null),f.push("/login"))});return()=>e()},[g,f]),(0,n.useEffect)(()=>{if(!m)return;let e=(0,r.C3)(),s=(0,r.KR)(e,"applications"),l=(0,r.Zy)(s,e=>{let s=e.val(),l=[];if(s)for(let e in s){let a={id:e,...s[e]};(a.companyUserId===m.uid||"TopJobs.lk"===a.jobSource)&&l.push(a)}a(l),d(!1),h("")},e=>{console.error("Error fetching applications:",e),h("Failed to load applications. Please check console."),d(!1)});return()=>l()},[m]);let k=async()=>{try{await (0,t.CI)(g),f.push("/login")}catch(e){console.error("Error logging out:",e),console.error("Failed to log out. Please try again.")}},y=(e,a)=>{if(!e||!a){console.error("Resume path or filename is missing.");return}let s=e.split("/").pop();window.open("http://localhost:5000/api/resumes/".concat(s),"_blank")},w=()=>{N(!1),u(null),j(null)},C=e.reduce((e,a)=>{let s=a.jobTitle||"Unknown Job";return e[s]||(e[s]=[]),e[s].push(a),e},{});return!m||s?(0,l.jsxs)("div",{className:"container mt-5 text-center",children:[(0,l.jsx)("div",{className:"spinner-border text-primary",role:"status",children:(0,l.jsx)("span",{className:"visually-hidden",children:"Loading..."})}),(0,l.jsx)("p",{className:"mt-2",children:"Loading applications..."})]}):o?(0,l.jsx)("div",{className:"container mt-5 alert alert-danger",children:o}):(0,l.jsxs)("div",{children:[(0,l.jsx)(c.A,{onLogout:k,userEmail:null==m?void 0:m.email}),(0,l.jsxs)("div",{className:"container mt-5",children:[(0,l.jsxs)("div",{className:"d-flex justify-content-between align-items-center mb-4",children:[(0,l.jsx)("h2",{children:"Applications for Your Jobs"}),(0,l.jsx)("button",{className:"btn btn-secondary",onClick:()=>f.push("/dashboard"),children:"Back to Dashboard"})]}),0===Object.keys(C).length?(0,l.jsx)("div",{className:"alert alert-info text-center",role:"alert",children:"No applications received for your jobs yet."}):(0,l.jsx)("div",{children:Object.entries(C).map(e=>{let[a,s]=e;return(0,l.jsxs)("div",{className:"card shadow mb-4",children:[(0,l.jsx)("div",{className:"card-header bg-light",children:(0,l.jsxs)("h4",{className:"mb-0",children:[a," (",s.length," Applications)"]})}),(0,l.jsx)("div",{className:"card-body p-0",children:(0,l.jsx)("div",{className:"table-responsive",children:(0,l.jsxs)("table",{className:"table table-striped table-hover mb-0",children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{children:"Applicant Email"}),(0,l.jsx)("th",{children:"Match %"})," ",(0,l.jsx)("th",{children:"Source"})," ",(0,l.jsx)("th",{children:"Applied At"}),(0,l.jsx)("th",{children:"Actions"})]})}),(0,l.jsx)("tbody",{children:s.map(e=>(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{children:e.candidateEmail}),(0,l.jsx)("td",{children:e.matchPercentage?"".concat(e.matchPercentage,"%"):"N/A"})," ",(0,l.jsx)("td",{children:e.jobSource||"N/A"})," ",(0,l.jsx)("td",{children:new Date(e.appliedAt).toLocaleString()}),(0,l.jsx)("td",{children:e.resumeFilePath?(0,l.jsx)("button",{className:"btn btn-sm btn-primary",onClick:()=>y(e.resumeFilePath,e.resumeFileName),children:"Download CV"}):(0,l.jsx)("span",{className:"text-muted",children:"Resume N/A"})})]},e.id))})]})})})]},a)})})]}),v&&(0,l.jsx)("div",{className:"modal show d-block",tabIndex:"-1",style:{backgroundColor:"rgba(0,0,0,0.5)"},children:(0,l.jsx)("div",{className:"modal-dialog modal-lg",children:(0,l.jsxs)("div",{className:"modal-content",children:[(0,l.jsxs)("div",{className:"modal-header bg-primary text-white",children:[(0,l.jsxs)("h5",{className:"modal-title",children:["Resume: ",x||"N/A"]}),(0,l.jsx)("button",{type:"button",className:"btn-close btn-close-white","aria-label":"Close",onClick:w})]}),(0,l.jsx)("div",{className:"modal-body",children:p?(0,l.jsx)("p",{children:(0,l.jsx)("a",{href:"http://localhost:5000/api/resumes/".concat(p.split("/").pop()),target:"_blank",rel:"noopener noreferrer",className:"btn btn-info",children:"Open/Download Resume"})}):(0,l.jsx)("p",{children:"Resume file not available."})}),(0,l.jsx)("div",{className:"modal-footer",children:(0,l.jsx)("button",{type:"button",className:"btn btn-secondary",onClick:w,children:"Close"})})]})})})]})}s(5538)},9366:(e,a,s)=>{"use strict";s.d(a,{A:()=>d});var l=s(7876),n=s(4232),r=s(8230),t=s.n(r),i=s(9917),c=s(5940);function d(e){let{onLogout:a,userEmail:s}=e,[r,d]=(0,n.useState)(null),o=(0,i.xI)(),h=(0,c.C3)();return(0,n.useEffect)(()=>{let e=(0,i.hg)(o,async e=>{if(e){let a=(0,c.KR)(h,"users/".concat(e.uid,"/role")),s=await (0,c.Jt)(a);s.exists()?d(s.val()):d(null)}else d(null)});return()=>e()},[o,h]),(0,l.jsx)("nav",{className:"navbar navbar-expand-lg navbar-dark bg-dark",children:(0,l.jsxs)("div",{className:"container-fluid",children:["company"===r?(0,l.jsx)(t(),{href:"/dashboard",className:"navbar-brand",children:"Company Portal"}):"candidate"===r?(0,l.jsx)(t(),{href:"/candidate-dashboard",className:"navbar-brand",children:"Candidate Portal"}):(0,l.jsx)(t(),{href:"/",className:"navbar-brand",children:"Job Matching Platform"}),(0,l.jsx)("button",{className:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarNav","aria-controls":"navbarNav","aria-expanded":"false","aria-label":"Toggle navigation",children:(0,l.jsx)("span",{className:"navbar-toggler-icon"})}),(0,l.jsxs)("div",{className:"collapse navbar-collapse",id:"navbarNav",children:[(0,l.jsxs)("ul",{className:"navbar-nav me-auto mb-2 mb-lg-0",children:["company"===r&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("li",{className:"nav-item",children:(0,l.jsx)(t(),{href:"/dashboard",className:"nav-link",children:"Dashboard"})}),(0,l.jsx)("li",{className:"nav-item",children:(0,l.jsx)(t(),{href:"/all-vacancies",className:"nav-link",target:"_blank",rel:"noopener noreferrer",children:"All Vacancies"})}),(0,l.jsx)("li",{className:"nav-item",children:(0,l.jsx)(t(),{href:"/view-vacancies",className:"nav-link",children:"My Vacancies"})})]}),"candidate"===r&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("li",{className:"nav-item",children:(0,l.jsx)(t(),{href:"/candidate-dashboard",className:"nav-link",children:"Dashboard"})}),(0,l.jsx)("li",{className:"nav-item",children:(0,l.jsx)(t(),{href:"/resume-matcher",className:"nav-link",children:"Platform Job Matcher"})}),(0,l.jsx)("li",{className:"nav-item",children:(0,l.jsx)(t(),{href:"/topjobs-matcher",className:"nav-link",children:"TopJobs.lk Matcher"})}),(0,l.jsx)("li",{className:"nav-item",children:(0,l.jsx)(t(),{href:"/all-vacancies",className:"nav-link",target:"_blank",rel:"noopener noreferrer",children:"View All Jobs"})})]}),!r&&(0,l.jsx)("li",{className:"nav-item",children:(0,l.jsx)(t(),{href:"/",className:"nav-link",children:"Home"})})]}),(0,l.jsxs)("ul",{className:"navbar-nav",children:[s&&(0,l.jsx)("li",{className:"nav-item",children:(0,l.jsxs)("span",{className:"nav-link text-white-50",children:["Signed in as: ",s]})}),(0,l.jsx)("li",{className:"nav-item",children:(0,l.jsx)("button",{className:"btn btn-outline-light ms-2",onClick:a,children:"Logout"})})]})]})]})})}s(5538)}},e=>{var a=a=>e(e.s=a);e.O(0,[7,166,3,230,636,593,792],()=>a(1044)),_N_E=e.O()}]);